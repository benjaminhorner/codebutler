define(['./hasOwn', './every', '../lang/isObject'], function(hasOwn, every, isObject) {

    /**
     * Description
     * @method defaultCompare
     * @param {} a
     * @param {} b
     * @return BinaryExpression
     */
    function defaultCompare(a, b) {
        return a === b;
    }

    // Makes a function to compare the object values from the specified compare
    // operation callback.
    /**
     * Description
     * @method makeCompare
     * @param {} callback
     * @return FunctionExpression
     */
    function makeCompare(callback) {
        return function(value, key) {
            return hasOwn(this, key) && callback(value, this[key]);
        };
    }

    /**
     * Description
     * @method checkProperties
     * @param {} value
     * @param {} key
     * @return CallExpression
     */
    function checkProperties(value, key) {
        return hasOwn(this, key);
    }

    /**
     * Checks if two objects have the same keys and values.
     */
    /**
     * Description
     * @method equals
     * @param {} a
     * @param {} b
     * @param {} callback
     * @return LogicalExpression
     */
    function equals(a, b, callback) {
        callback = callback || defaultCompare;

        if (!isObject(a) || !isObject(b)) {
            return callback(a, b);
        }

        return (every(a, makeCompare(callback), b) &&
                every(b, checkProperties, a));
    }

    return equals;
});
